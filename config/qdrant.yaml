# =============================
# config/qdrant.yaml
# Qdrant Configuration for Person ReID System
# =============================

qdrant:
  # Connection settings
  connection:
    url: "https://29cd6d37-e60d-4f16-a7b1-a7afba0d80e1.europe-west3-0.gcp.cloud.qdrant.io:6333"  # Change to your Qdrant instance URL
    api_key: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhY2Nlc3MiOiJtIn0.h1VmZzlKmAOlrLpzDwwFWicJ9drx4KAVsa9SK08f1k0" # Set if using Qdrant Cloud
    timeout: 60.0
    prefer_grpc: false
  
  # Collection settings
  collection:
    name: "person_reid_embeddings"
    vector_size: 256               # MobileNet from DeepSort (change to 512 if using OSNet)
    distance: "Cosine"             # Cosine similarity for ReID
    on_disk_payload: false
    
  # Batch upload settings
  upload:
    batch_size: 50
    retry_count: 3
    retry_delay: 2                 # seconds
    wait: true                     # Wait for indexing to complete
  
  # Search settings
  search:
    similarity_threshold: 0.65     # Minimum cosine similarity for match
    top_k: 10                      # Number of results to return
    cross_camera_only: true        # Only search across different cameras
  
  # Clustering settings
  clustering:
    method: "connected_components" # Algorithm: connected_components, dbscan, greedy
    similarity_threshold: 0.70     # Higher threshold for clustering (stricter)
    distance_threshold: 0.30       # 1 - similarity_threshold for distance-based methods
    min_cluster_size: 1            # Minimum points to form a cluster (was 2, now 1 to allow singles)
    min_cameras: 1                 # ADDED: Minimum cameras required (was missing!)
    enable_auto_clustering: true